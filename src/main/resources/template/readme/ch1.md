# Test - Driven Development : By Example
**TDD를 쫒아가려 하지 말고 TDD가 나를 쫒아오게 해라**

## TDD 수련법
처음 훈련 방법
1. 간단하고 쉬운 문제들을 TDD로 시도합니다. 가능하면 전에 접하고, 프로그래밍해본 문제가 좋습니다.
2. 초록 막대 주기는 가능하면 짧도록 합니다. ex) a=b+3Xc를 입력하고자 할 때, a= 까지 입력한 시점은 빨간 막대 시점입니다. 그 시점에서 테스트를 실행하면 분명히 실패할 것이기 때문입니다. 가능한 초록 막대가 나오도록 해야 합니다.
3. 이때 초록 막대 주기의 최대 시간을 정해놓고 진행하다가 시간을 초과하면 직전 초록 막대 상태로 돌린다음 새로 시작하는 것이 좋습니다.
4. 진짜로 만들기 전까지만 가짜로 구현하기를 적극적으로 사용하려고 노력합니다. 가짜로 구현하기는 초록 막대 주기가 짧아지는 가장 간단하고 빠른 방법 입니다.
5. 같은 문제를 여러번 풀어봅니다. 동일한 프로그램이 나오나요? 무엇이 비슷하고 무엇이 틀린가요? 뭘 배웠나요?
6. 초기에는 리팩토링 툴을 사용하지 않는 것이 좋습니다. 초보에겐 순서와 과정이 중요합니다.

## 프로그래밍 순서
1. 빨강 - 실패하는 작은 테스트를 작성한다. 처음에는 컴파일 조차 되지 않을 수 있음
2. 초록 - 빨리 테스트가 통과하도록 만든다. 이를 위해 어떤 죄악을 저질러도 좋다.
3. 리팩토링 - 일단 테스트를 통과하게만 하는 와중에 생겨난 모든 중복을 제거한다.

# 화폐 예제
TDD 리듬을 보도록 하자.
1. 재빠르게 테스트를 하나 추가한다.
2. 테스트를 모두 실행 후 새로 추가한 것이 실패하는지 확인한다.
3. 코드를 변경한다
4. 모든 테스트를 실행하고 전부 성공하는지 확인한다
5. 리팩토링을 통해 중복을 제거한다.

## 다중 Money를 지원하는 화폐예제
- 리스트
    1. $5 + 10CHF = $10
    2. **$5 X 2 = $10**
    3. amount 를 private 만들기
    4. Dollar 부작용?
    5. Money 반올림?
```
public class Dollar {
    public int amount;
    
    public Dollar(int amount) {
        this.amount = amount;
    }

    public void times(int multiplier) {
        amount *= multiplier;
    }
}

@Test
void testMultiplication() {
    Dollar five = new Dollar(5);
    five.times(2);
    assertEquals(10, five.amount);
}

```
- 리스트
    1. $5 + 10CHF = $10
    2. ~~$5 X 2 = $10~~
    3. amount 를 private 만들기
    4. Dollar 부작용?
    5. Money 반올림?

위 첫 번째 테스트를 진행하면서 한 작업
1. 우리가 알고 있는 작업해야 할 테스트 목록을 만들었다.
2. 오퍼레이션이 외부에서 어떻게 보이길 우너하는지 말해주는 이야기를 코드로 표현했다.
3. JUnit에 대한 상세한 사항들은 잠시 무시하기로 했다.
4. 스텁 구현을 통해 테스트를 컴파일했다.
5. 끔찍한 죄악을 범하여 테스틀 통과했다.
6. 돌아가는 코드에서 상수를 변수로 변경하여 점진적으로 일반화했다.
7. 새로운 할일들을 한번에 처리하는 대신 할일 목록에 추가하고 넘어갔다.

## 타락한 객체
일반적인 TDD 주기는 다음과 같다

1. 테스트를 작성한다. 마음속에 있는 오퍼레이션이 코드에 어떤 식으로 나타나길 원하는지 이야기를 써내려간다. 올바른 답으로 향하는 모든 요소를 포함시킨다.
2. 실행 가능하게 만든다. 깔끔하고 단순한 해법이 명백히 보인다면 그것을 입력하라. 만약 깔끔하고 단순한 해법이 있지만 구현하는 데 몇 분 정도 걸릴 것 같으면 일단 적어 놓은 뒤에 원래 문제로 돌아오자. 빨리 초록 막대를 보는 것은 잠시동안 모든 죄를 사죄해준다.
3. 이전 죄악을 수습하여 소프트웨어 정의의 길로 돌아와 중복을 제거하고 초록막대로 돌린다.

- 리스트
    1. $5 + 10CHF = $10
    2. ~~$5 X 2 = $10~~
    3. amount 를 private 만들기
    4. **Dollar 부작용?**
    5. Money 반올림?
```
public class Dollar {
    public int amount;

    public Dollar(int amount) {
        this.amount = amount;
    }

    public Dollar times(int multiplier) {
        return new Dollar(amount * multiplier);
    }
}

@Test
void testMultiplication() {
    Dollar five = new Dollar(5);
    Dollar product = five.times(2);
    assertEquals(10, product.amount);
    product = five.times(3);
    assertEquals(15, product.amount);
}
```
가장 빠른 초록색 막대를 보기위한 전략 3가지
1. 가짜로 구현하기 : 상수를 반환하게 만들고 진짜 코드를 얻을 때까지 단계적으로 상수를 변수로 변경한다.
2. 명백한 구현 사용하기 : 실제 구현을 입력한다.
3. 삼각층량(3장에서)

우리가 한 방법
1. 설계상 결함으로 실패하는 테스트 코드를 제작
2. 스텁 구현으로 빠르게 컴파일을 통과하는 테스트 코드를 제작
3. 올바르다고 생각하는 코드를 입력하여 테스트를 통과했다.

- 리스트
    1. $5 + 10CHF = $10
    2. ~~$5 X 2 = $10~~
    3. amount 를 private 만들기
    4. ~~Dollar 부작용?~~
    5. Money 반올림?
## 모두를 위한 평등